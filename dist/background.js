function fetchBlockedUrlsAndStore(){chrome.storage.local.get(["token"],(function(e){const t=e.token;t?fetch("http://localhost:5000/getBlockedUrls",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then((e=>e.json())).then((e=>{"ok"===e.status&&e.blockedUrls&&chrome.storage.local.set({blockedUrls:e.blockedUrls})})).catch((e=>console.error("Error fetching blocked URLs:",e))):console.log("No token found in storage.")}))}function fetchCustomPreferencesAndStore(){chrome.storage.local.get(["token"],(function(e){const t=e.token;t?fetch("http://localhost:5000/getCustomPreferences",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then((e=>e.json())).then((e=>{"ok"===e.status&&e.customPreferences&&chrome.storage.local.set({customPreferences:e.customPreferences})})).catch((e=>console.error("Error fetching custom preferences:",e))):console.log("No token found in storage.")}))}chrome.runtime.onInstalled.addListener((()=>{fetchBlockedUrlsAndStore(),fetchCustomPreferencesAndStore()})),chrome.runtime.onStartup.addListener((()=>{fetchBlockedUrlsAndStore(),fetchCustomPreferencesAndStore()})),setInterval(fetchBlockedUrlsAndStore,3e4),setInterval(fetchCustomPreferencesAndStore,3e4),chrome.tabs.onUpdated.addListener(((e,t,o)=>{"complete"===t.status&&o.url&&chrome.storage.local.get(["blockedUrls","customPreferences"],(t=>{const{blockedUrls:r=[],customPreferences:c=[]}=t,s=r.some((e=>o.url.includes(e))),n=c.some((e=>o.url.includes(e)));(s||n)&&chrome.tabs.update(e,{url:"./dashboard.html"})}))})),chrome.runtime.onMessage.addListener(((e,t,o)=>{"redirect"===e.action&&t.tab&&chrome.tabs.update(t.tab.id,{url:e.url})}));